#!/bin/bash
# define solrHome root
orig_dir=$(pwd)
cd ${0%/*}/..
solr_root=$(pwd)
# path to scripts.conf with configuration settings for master-slave and rsync
. ${solr_root}/conf/scripts.conf

log=${solr_root}/logs/snapinstaller.ep.log

# run commit for an each index
for index in ${indexlist}
do
# all parameters are listed commit.ep
#       -h          specify Solr hostname (defaults to localhost)
#       -p          specify Solr port number
#       -w          specify name of Solr webapp (defaults to solr)
#       -u          specify user to sudo to before running script
#       -U          specify full update url (overrides -h,-p,-w parameters)
#       -i          specify index name or you can fed up -w ${app_name}/${index} and not specify -i
#       -v          increase verbosity
	cmd="${solrPathSlave}/bin/commit.ep -h ${solr_hostname} -p ${solr_port} -u ${user} -w ${app_name}/${index} -v"
	${cmd} 1>> ${log} 2>&1
done
# run commit for an each spell check index
for spell in ${spelllist}
do
	cmd="${solrPathSlave}/bin/commit.ep -U http://${solr_hostname}:${solr_port}/searchserver/product/update/?qt=spellchecker -u ${user} -v"      
	${cmd} 1>> ${log} 2>&1
done
